LAYER_NAME: all_layers
2020-07-21 13:06:54.825136: I tensorflow_io/core/kernels/cpu_check.cc:128] Your CPU supports instructions that this TensorFlow IO binary was not compiled to use: AVX2 AVX512F FMA
2020-07-21 13:07:10.037128: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-21 13:07:10.240780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:1d:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:10.242868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:1e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:10.244927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:1f:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:10.246993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 3 with properties: 
pciBusID: 0000:20:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:10.350228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-07-21 13:07:10.776735: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-07-21 13:07:11.019722: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-07-21 13:07:11.308603: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-07-21 13:07:11.920126: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-07-21 13:07:12.149462: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-07-21 13:07:13.130044: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-07-21 13:07:13.146028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2, 3
2020-07-21 13:07:21.278395: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-21 13:07:21.311228: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2100000000 Hz
2020-07-21 13:07:21.312957: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f564daefb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-21 13:07:21.312987: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-21 13:07:21.855241: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f5640746c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-21 13:07:21.855278: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-21 13:07:21.855286: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-21 13:07:21.855292: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-21 13:07:21.855298: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-21 13:07:21.860282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:1d:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:21.862214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:1e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:21.864133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:1f:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:21.865973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 3 with properties: 
pciBusID: 0000:20:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-21 13:07:21.866012: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-07-21 13:07:21.866024: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-07-21 13:07:21.866035: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-07-21 13:07:21.866047: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-07-21 13:07:21.866058: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-07-21 13:07:21.866075: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-07-21 13:07:21.866087: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-07-21 13:07:21.881205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2, 3
2020-07-21 13:07:21.881246: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-07-21 13:07:21.890012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-21 13:07:21.890031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 1 2 3 
2020-07-21 13:07:21.890040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N N N N 
2020-07-21 13:07:21.890046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 1:   N N N N 
2020-07-21 13:07:21.890052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 2:   N N N N 
2020-07-21 13:07:21.890058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 3:   N N N N 
2020-07-21 13:07:21.902003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10176 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:1d:00.0, compute capability: 7.5)
2020-07-21 13:07:21.904568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10176 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:1e:00.0, compute capability: 7.5)
2020-07-21 13:07:21.907020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10176 MB memory) -> physical GPU (device: 2, name: GeForce RTX 2080 Ti, pci bus id: 0000:1f:00.0, compute capability: 7.5)
2020-07-21 13:07:21.909493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10176 MB memory) -> physical GPU (device: 3, name: GeForce RTX 2080 Ti, pci bus id: 0000:20:00.0, compute capability: 7.5)
WARNING:tensorflow:From /home/hauthj/.conda/envs/gpu-env/lib/python3.8/site-packages/tensorflow_probability/python/layers/util.py:99: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
2.2.0
Listing all GPU resources:
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:3', device_type='GPU')]

0.10.0
------------------------------
Constructing model...
------------------------------

Input size: (None, 144, 144, 4)
Output size: (None, 144, 144, 1)
Model summary:
Model: "model_all_layers"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_layer (InputLayer)        [(None, 144, 144, 4) 0                                            
__________________________________________________________________________________________________
encoder_1_a (Conv2DFlipout)     (None, 144, 144, 32) 2368        input_layer[0][0]                
__________________________________________________________________________________________________
encoder_1_b (Conv2DFlipout)     (None, 144, 144, 32) 18496       encoder_1_a[0][0]                
__________________________________________________________________________________________________
downsample_1 (MaxPooling2D)     (None, 72, 72, 32)   0           encoder_1_b[0][0]                
__________________________________________________________________________________________________
encoder_2_a (Conv2DFlipout)     (None, 72, 72, 64)   36992       downsample_1[0][0]               
__________________________________________________________________________________________________
encoder_2_b (Conv2DFlipout)     (None, 72, 72, 64)   73856       encoder_2_a[0][0]                
__________________________________________________________________________________________________
downsample_2 (MaxPooling2D)     (None, 36, 36, 64)   0           encoder_2_b[0][0]                
__________________________________________________________________________________________________
encoder_3_a (Conv2DFlipout)     (None, 36, 36, 128)  147712      downsample_2[0][0]               
__________________________________________________________________________________________________
encoder_3_b (Conv2DFlipout)     (None, 36, 36, 128)  295168      encoder_3_a[0][0]                
__________________________________________________________________________________________________
downsample_3 (MaxPooling2D)     (None, 18, 18, 128)  0           encoder_3_b[0][0]                
__________________________________________________________________________________________________
encoder_4_a (Conv2DFlipout)     (None, 18, 18, 256)  590336      downsample_3[0][0]               
__________________________________________________________________________________________________
encoder_4_b (Conv2DFlipout)     (None, 18, 18, 256)  1180160     encoder_4_a[0][0]                
__________________________________________________________________________________________________
downsample_4 (MaxPooling2D)     (None, 9, 9, 256)    0           encoder_4_b[0][0]                
__________________________________________________________________________________________________
encoder_5_a (Conv2DFlipout)     (None, 9, 9, 512)    2360320     downsample_4[0][0]               
__________________________________________________________________________________________________
encoder_5_b (Conv2DFlipout)     (None, 9, 9, 512)    4719616     encoder_5_a[0][0]                
__________________________________________________________________________________________________
upsample_4 (UpSampling2D)       (None, 18, 18, 512)  0           encoder_5_b[0][0]                
__________________________________________________________________________________________________
concat_4 (Concatenate)          (None, 18, 18, 768)  0           upsample_4[0][0]                 
                                                                 encoder_4_b[0][0]                
__________________________________________________________________________________________________
decoder_4_a (Conv2DFlipout)     (None, 18, 18, 256)  3539456     concat_4[0][0]                   
__________________________________________________________________________________________________
decoder_4_b (Conv2DFlipout)     (None, 18, 18, 256)  1180160     decoder_4_a[0][0]                
__________________________________________________________________________________________________
upsample_3 (UpSampling2D)       (None, 36, 36, 256)  0           decoder_4_b[0][0]                
__________________________________________________________________________________________________
concat_3 (Concatenate)          (None, 36, 36, 384)  0           upsample_3[0][0]                 
                                                                 encoder_3_b[0][0]                
__________________________________________________________________________________________________
decoder_3_a (Conv2DFlipout)     (None, 36, 36, 128)  884992      concat_3[0][0]                   
__________________________________________________________________________________________________
decoder_3_b (Conv2DFlipout)     (None, 36, 36, 128)  295168      decoder_3_a[0][0]                
__________________________________________________________________________________________________
upsample_2 (UpSampling2D)       (None, 72, 72, 128)  0           decoder_3_b[0][0]                
__________________________________________________________________________________________________
concat_2 (Concatenate)          (None, 72, 72, 192)  0           upsample_2[0][0]                 
                                                                 encoder_2_b[0][0]                
__________________________________________________________________________________________________
decoder_2_a (Conv2DFlipout)     (None, 72, 72, 64)   221312      concat_2[0][0]                   
__________________________________________________________________________________________________
decoder_2_b (Conv2DFlipout)     (None, 72, 72, 64)   73856       decoder_2_a[0][0]                
__________________________________________________________________________________________________
upsample_1 (UpSampling2D)       (None, 144, 144, 64) 0           decoder_2_b[0][0]                
__________________________________________________________________________________________________
concat_1 (Concatenate)          (None, 144, 144, 96) 0           upsample_1[0][0]                 
                                                                 encoder_1_b[0][0]                
__________________________________________________________________________________________________
decoder_1_a (Conv2DFlipout)     (None, 144, 144, 32) 55360       concat_1[0][0]                   
__________________________________________________________________________________________________
decoder_1_b (Conv2DFlipout)     (None, 144, 144, 32) 18496       decoder_1_a[0][0]                
__________________________________________________________________________________________________
output_layer (Conv2DFlipout)    (None, 144, 144, 1)  66          decoder_1_b[0][0]                
==================================================================================================
Total params: 15,693,890
Trainable params: 15,693,890
Non-trainable params: 0
__________________________________________________________________________________________________
None
Model losses:
[<tf.Tensor: shape=(), dtype=float32, numpy=5528.1455>, <tf.Tensor: shape=(), dtype=float32, numpy=153.557>, <tf.Tensor: shape=(), dtype=float32, numpy=44219.293>, <tf.Tensor: shape=(), dtype=float32, numpy=153.57886>, <tf.Tensor: shape=(), dtype=float32, numpy=88452.64>, <tf.Tensor: shape=(), dtype=float32, numpy=306.9406>, <tf.Tensor: shape=(), dtype=float32, numpy=176887.28>, <tf.Tensor: shape=(), dtype=float32, numpy=307.29883>, <tf.Tensor: shape=(), dtype=float32, numpy=353787.44>, <tf.Tensor: shape=(), dtype=float32, numpy=614.49426>, <tf.Tensor: shape=(), dtype=float32, numpy=707520.5>, <tf.Tensor: shape=(), dtype=float32, numpy=613.9995>, <tf.Tensor: shape=(), dtype=float32, numpy=1415091.6>, <tf.Tensor: shape=(), dtype=float32, numpy=1228.1304>, <tf.Tensor: shape=(), dtype=float32, numpy=2830119.0>, <tf.Tensor: shape=(), dtype=float32, numpy=1228.0988>, <tf.Tensor: shape=(), dtype=float32, numpy=5660387.0>, <tf.Tensor: shape=(), dtype=float32, numpy=2457.8132>, <tf.Tensor: shape=(), dtype=float32, numpy=11320816.0>, <tf.Tensor: shape=(), dtype=float32, numpy=2457.276>, <tf.Tensor: shape=(), dtype=float32, numpy=8490543.0>, <tf.Tensor: shape=(), dtype=float32, numpy=1227.561>, <tf.Tensor: shape=(), dtype=float32, numpy=2830180.5>, <tf.Tensor: shape=(), dtype=float32, numpy=1228.2273>, <tf.Tensor: shape=(), dtype=float32, numpy=2122718.2>, <tf.Tensor: shape=(), dtype=float32, numpy=615.08325>, <tf.Tensor: shape=(), dtype=float32, numpy=707527.4>, <tf.Tensor: shape=(), dtype=float32, numpy=614.454>, <tf.Tensor: shape=(), dtype=float32, numpy=530668.06>, <tf.Tensor: shape=(), dtype=float32, numpy=307.0183>, <tf.Tensor: shape=(), dtype=float32, numpy=176897.72>, <tf.Tensor: shape=(), dtype=float32, numpy=307.34543>, <tf.Tensor: shape=(), dtype=float32, numpy=132665.69>, <tf.Tensor: shape=(), dtype=float32, numpy=153.47714>, <tf.Tensor: shape=(), dtype=float32, numpy=44218.57>, <tf.Tensor: shape=(), dtype=float32, numpy=153.70943>, <tf.Tensor: shape=(), dtype=float32, numpy=153.52869>, <tf.Tensor: shape=(), dtype=float32, numpy=4.794789>]
------------------------------
Loading training and testing data...
------------------------------
------------------------------
Fitting model with training data ...
------------------------------
Training the model started at 2020-07-21 13:09:32.163128
Traceback (most recent call last):
  File "./all_layers_bayesian.py", line 75, in <module>
    model.load(SAVE_PATH)
AttributeError: 'Model' object has no attribute 'load'
