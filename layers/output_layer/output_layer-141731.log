LAYER_NAME: output_layer
2020-07-08 18:07:09.079807: I tensorflow_io/core/kernels/cpu_check.cc:128] Your CPU supports instructions that this TensorFlow IO binary was not compiled to use: AVX2 AVX512F FMA
2020-07-08 18:07:10.708375: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-08 18:07:10.856168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:1d:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-08 18:07:10.858271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:1e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-08 18:07:10.860320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:1f:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-08 18:07:10.866457: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-07-08 18:07:10.893763: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-07-08 18:07:10.910159: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-07-08 18:07:10.923249: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-07-08 18:07:10.948307: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-07-08 18:07:10.962188: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-07-08 18:07:11.014226: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-07-08 18:07:11.026586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2
2020-07-08 18:07:11.795702: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-08 18:07:11.806869: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2100000000 Hz
2020-07-08 18:07:11.808808: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562edf353850 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-08 18:07:11.808837: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-08 18:07:12.307697: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562edf3bdcf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-08 18:07:12.307733: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-08 18:07:12.307741: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-08 18:07:12.307747: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-07-08 18:07:12.312013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:1d:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-08 18:07:12.313970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:1e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-08 18:07:12.315903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:1f:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.73GiB deviceMemoryBandwidth: 573.69GiB/s
2020-07-08 18:07:12.315939: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-07-08 18:07:12.315952: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-07-08 18:07:12.315963: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-07-08 18:07:12.315973: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-07-08 18:07:12.315983: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-07-08 18:07:12.315993: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-07-08 18:07:12.316004: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-07-08 18:07:12.327420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2
2020-07-08 18:07:12.327458: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-07-08 18:07:12.334051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-08 18:07:12.334069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 1 2 
2020-07-08 18:07:12.334078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N N N 
2020-07-08 18:07:12.334084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 1:   N N N 
2020-07-08 18:07:12.334090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 2:   N N N 
2020-07-08 18:07:12.343639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10176 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:1d:00.0, compute capability: 7.5)
2020-07-08 18:07:12.346183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10176 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:1e:00.0, compute capability: 7.5)
2020-07-08 18:07:12.348709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10176 MB memory) -> physical GPU (device: 2, name: GeForce RTX 2080 Ti, pci bus id: 0000:1f:00.0, compute capability: 7.5)
WARNING:tensorflow:From /home/hauthj/.conda/envs/gpu-env/lib/python3.8/site-packages/tensorflow_probability/python/layers/util.py:99: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
2020-07-08 18:09:21.970308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-07-08 18:09:29.006513: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2.2.0
Listing all GPU resources:
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')]

0.10.0
------------------------------
Constructing model...
------------------------------

Input size: (None, 144, 144, 4)
Output size: (None, 144, 144, 1)
Model summary:
Model: "model_output_layer"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_layer (InputLayer)        [(None, 144, 144, 4) 0                                            
__________________________________________________________________________________________________
encoder_1_a (Conv2D)            (None, 144, 144, 32) 1184        input_layer[0][0]                
__________________________________________________________________________________________________
encoder_1_b (Conv2D)            (None, 144, 144, 32) 9248        encoder_1_a[0][0]                
__________________________________________________________________________________________________
downsample_1 (MaxPooling2D)     (None, 72, 72, 32)   0           encoder_1_b[0][0]                
__________________________________________________________________________________________________
encoder_2_a (Conv2D)            (None, 72, 72, 64)   18496       downsample_1[0][0]               
__________________________________________________________________________________________________
encoder_2_b (Conv2D)            (None, 72, 72, 64)   36928       encoder_2_a[0][0]                
__________________________________________________________________________________________________
downsample_2 (MaxPooling2D)     (None, 36, 36, 64)   0           encoder_2_b[0][0]                
__________________________________________________________________________________________________
encoder_3_a (Conv2D)            (None, 36, 36, 128)  73856       downsample_2[0][0]               
__________________________________________________________________________________________________
encoder_3_b (Conv2D)            (None, 36, 36, 128)  147584      encoder_3_a[0][0]                
__________________________________________________________________________________________________
downsample_3 (MaxPooling2D)     (None, 18, 18, 128)  0           encoder_3_b[0][0]                
__________________________________________________________________________________________________
encoder_4_a (Conv2D)            (None, 18, 18, 256)  295168      downsample_3[0][0]               
__________________________________________________________________________________________________
encoder_4_b (Conv2D)            (None, 18, 18, 256)  590080      encoder_4_a[0][0]                
__________________________________________________________________________________________________
downsample_4 (MaxPooling2D)     (None, 9, 9, 256)    0           encoder_4_b[0][0]                
__________________________________________________________________________________________________
encoder_5_a (Conv2D)            (None, 9, 9, 512)    1180160     downsample_4[0][0]               
__________________________________________________________________________________________________
encoder_5_b (Conv2D)            (None, 9, 9, 512)    2359808     encoder_5_a[0][0]                
__________________________________________________________________________________________________
upsample_4 (UpSampling2D)       (None, 18, 18, 512)  0           encoder_5_b[0][0]                
__________________________________________________________________________________________________
concat_4 (Concatenate)          (None, 18, 18, 768)  0           upsample_4[0][0]                 
                                                                 encoder_4_b[0][0]                
__________________________________________________________________________________________________
decoder_4_a (Conv2D)            (None, 18, 18, 256)  1769728     concat_4[0][0]                   
__________________________________________________________________________________________________
decoder_4_b (Conv2D)            (None, 18, 18, 256)  590080      decoder_4_a[0][0]                
__________________________________________________________________________________________________
upsample_3 (UpSampling2D)       (None, 36, 36, 256)  0           decoder_4_b[0][0]                
__________________________________________________________________________________________________
concat_3 (Concatenate)          (None, 36, 36, 384)  0           upsample_3[0][0]                 
                                                                 encoder_3_b[0][0]                
__________________________________________________________________________________________________
decoder_3_a (Conv2D)            (None, 36, 36, 128)  442496      concat_3[0][0]                   
__________________________________________________________________________________________________
decoder_3_b (Conv2D)            (None, 36, 36, 128)  147584      decoder_3_a[0][0]                
__________________________________________________________________________________________________
upsample_2 (UpSampling2D)       (None, 72, 72, 128)  0           decoder_3_b[0][0]                
__________________________________________________________________________________________________
concat_2 (Concatenate)          (None, 72, 72, 192)  0           upsample_2[0][0]                 
                                                                 encoder_2_b[0][0]                
__________________________________________________________________________________________________
decoder_2_a (Conv2D)            (None, 72, 72, 64)   110656      concat_2[0][0]                   
__________________________________________________________________________________________________
decoder_2_b (Conv2D)            (None, 72, 72, 64)   36928       decoder_2_a[0][0]                
__________________________________________________________________________________________________
upsample_1 (UpSampling2D)       (None, 144, 144, 64) 0           decoder_2_b[0][0]                
__________________________________________________________________________________________________
concat_1 (Concatenate)          (None, 144, 144, 96) 0           upsample_1[0][0]                 
                                                                 encoder_1_b[0][0]                
__________________________________________________________________________________________________
decoder_1_a (Conv2D)            (None, 144, 144, 32) 27680       concat_1[0][0]                   
__________________________________________________________________________________________________
decoder_1_b (Conv2D)            (None, 144, 144, 32) 9248        decoder_1_a[0][0]                
__________________________________________________________________________________________________
output_layer (Conv2DFlipout)    (None, 144, 144, 1)  132         decoder_1_b[0][0]                
==================================================================================================
Total params: 7,847,044
Trainable params: 7,847,044
Non-trainable params: 0
__________________________________________________________________________________________________
None
Model losses:
[<tf.Tensor: shape=(), dtype=float32, numpy=0.0009571196>, <tf.Tensor: shape=(), dtype=float32, numpy=1.4349353e-05>]
------------------------------
Loading training and testing data...
------------------------------
------------------------------
Fitting model with training data ...
------------------------------
Training the model started at 2020-07-08 18:07:56.880433
Epoch 1/200
457/457 - 87s - loss: 260009.4688 - mean_binary_crossentropy: 4.3327 - likelihood_loss: 259960.0000 - val_loss: 232022.9062 - val_mean_binary_crossentropy: 3.8702 - val_likelihood_loss: 232214.8906
Epoch 2/200
457/457 - 81s - loss: 222812.6875 - mean_binary_crossentropy: 3.7174 - likelihood_loss: 223044.7656 - val_loss: 220118.5156 - val_mean_binary_crossentropy: 3.6556 - val_likelihood_loss: 219338.0781
Epoch 3/200
457/457 - 80s - loss: 247607.2812 - mean_binary_crossentropy: 4.1226 - likelihood_loss: 247356.7969 - val_loss: 228165.2188 - val_mean_binary_crossentropy: 3.8098 - val_likelihood_loss: 228588.0469
Epoch 4/200
457/457 - 81s - loss: 220941.4844 - mean_binary_crossentropy: 3.6830 - likelihood_loss: 220978.5781 - val_loss: 269258.3125 - val_mean_binary_crossentropy: 4.4820 - val_likelihood_loss: 268917.4375
Epoch 5/200
457/457 - 80s - loss: 237017.8125 - mean_binary_crossentropy: 3.9509 - likelihood_loss: 237054.8750 - val_loss: 220221.9062 - val_mean_binary_crossentropy: 3.6943 - val_likelihood_loss: 221657.0000
Epoch 6/200
457/457 - 80s - loss: 229243.2188 - mean_binary_crossentropy: 3.8200 - likelihood_loss: 229201.1562 - val_loss: 201896.7188 - val_mean_binary_crossentropy: 3.3517 - val_likelihood_loss: 201102.2500
Epoch 7/200
457/457 - 80s - loss: 221333.3281 - mean_binary_crossentropy: 3.6926 - likelihood_loss: 221555.2344 - val_loss: 245293.0938 - val_mean_binary_crossentropy: 4.0838 - val_likelihood_loss: 245027.8438
